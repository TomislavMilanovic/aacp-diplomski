\chapter{Realizacija univerzalne palete komandi}

\section{Dizajn}

\begin{figure}[!htbp]
	\begin{center}
		\includegraphics[height=4.5cm,width=8.5cm,keepaspectratio=true]{snv_design}
		\caption{Skica željenog izgleda univerzalne palete komandi}
		\label{fig:snv_design}
	\end{center}
\end{figure}

Na slici \ref{fig:snv_design} prikazan je željeni izgled univerzalne palete komandi koji se sastoji od dvije osnovne cjeline: polja za unos teksta i liste komandi. Pritom, maksimalni broj vidljivih komandi u listi æe se moæi podesiti (poèetna postavka je sedam komandi). Ukoliko se u listi komandi nalazi više stavki od tog broja, pojavljuje se vertikalna traka za pomicanje (eng. \textit{scrollbar}) kako bi korisnici mogli imati pristup svim komandama. Uvijek je oznaèena samo jedna komanda a unosom odreðenog pojma prikazuje se lista komandi koja odgovara tom pojmu, kako je prikazano na slici.

Paletom æe se moæi upravljati s tipkovnicom (koristeæi strelice za gore i dolje te \textit{Enter} za odabir komande) ili s mišem (korištenjem trake za pomicanje i klikanjem na željenu komandu).

\begin{figure}[!htbp]
	\begin{center}
		\includegraphics[height=4.5cm,width=8.5cm,keepaspectratio=true]{snv_app_aware}
		\caption{Univerzalna paleta komandi je svjesna aplikacije koju korisnik trenutno upotrebljava}
		\label{fig:snv_app_aware}
	\end{center}
\end{figure}

Glavna znaèajka univerzalne palete komandi je njena svjesnost aplikacije koju korisnik trenutno upotrebljava, što je vidljivo na slici \ref{fig:snv_app_aware} (prikazane komande su samo za demonstraciju koncepta). Ovisno o aplikaciji, izbor komandi se razlikuje.

Dodatno, univerzalna paleta komandi æe pamtiti i frekvenciju korištenja svake komande, kako bi one koje se najèešæe koriste bile prikazane na vrhu liste. Nakon iznesenih zahtjeva, nameæu se sljedeæi izazovi:
\begin{itemize}
	\item Kako prepoznati aplikaciju koja se trenutno koristi?
	\item Koji je univerzalan naèin na koji neki program može izvršiti bilo koju radnju u nekom drugom programu?
\end{itemize}

Prvi problem je riješen tako da se koristi alat za prepoznavanje procesa kojem trenutno fokusirani prozor pripada te se u skladu s time uèitava odgovarajuæa lista komandi. Kod drugog izazova, izvršavanje komandi se postiže emulacijom tipkovnièkih preèaca. Primjerice, kod izvršavanja komande \textit{Otvori datoteku}, univerzalna paleta æe emulirati tipkovnièki preèac \textit{Ctrl + O}.

Tipkovnièki preèaci su koncept koji je široko rasprostranjen u softveru na klasiènim, \textit{desktop} raèunalima, gdje se koriste miš i tipkovnica. Gotovo da nema aplikacije koja ih ne koristi kako bi svojim korisnicima pružila ubrzani rad s aplikacijom. Zbog toga, emuliranje preèaca donosi \textbf{univerzalnost} ovom programu.

\section{Dijagram toka}

\begin{figure}[!htbp]
	\begin{center}
		\includegraphics[height=17cm,width=17cm,keepaspectratio=true]{snv_flow_diagram}
		\caption{Dijagram toka rada univerzalne palete komandi}
		\label{fig:snv_flow_diagram}
	\end{center}
\end{figure}

Cjelokupni naèin rada univerzalne palete komandi prikazan je na slici \ref{fig:snv_flow_diagram}. Veæinu vremena, ovaj program æe provesti kao pozadinski proces (eng. \textit{daemon}) te æe osluškivati korisnikove unose na tipkovnici. U trenutku kada korisnik upotrijebi \textit{meta-preèac}, koji je u ovom radu podešen na "Ctrl + Win Key", program æe provjeriti prvo je li aplikacija koji se trenutno koristi podržana. Ako nije, ništa se neæe dogoditi, no ako je, uèitat æe se lista komandi i paleta æe se prikazati na ekranu.

Korisnik može pretražiti i izvršiti željenu komandu ili može zatvoriti paletu korištenjem tipke \textit{Esc} ili gubitkom fokusa na prozor palete.

\section{Implementacija}

Univerzalna paleta komandi implementirana je za sustave bazirane na Linuxu. Konkretno, koristila se Antergos distribucija s \textbf{KDE} okolišem. Temelji se na programskom jeziku Python 3.7.2 i sljedeæim modulima:

\begin{itemize}
	\item \textit{Tkinter} - \textit{de-facto} standardni paket za razvoj GUI aplikacija, temeljen na \textbf{Tcl/Tk} alatima \cite{2_2019}. Služi za implementaciju korisnièkog suèelja univerzalne palete komandi.
	\item \textit{PyAutoGUI} - modul za programatsko izvršavanje (emulaciju) uporabe miša i tipkovnice. Koristi se za emulaciju tipkovnièkih preèaca, èime univerzalna paleta komandi izvršava neku radnju u bilo kojoj drugoj aplikaciji.
	\item \textit{pynput} - knjižnica funkcija za osluškivanje korisnikovog unosa na tipkovnici. Omoguæava uporabu meta-preèaca za pozivanje univerzalne palete komandi.
\end{itemize}

Za prepoznavanje aplikacije koju korisnik trenutno upotrebljava koristimo Linux alat \textit{xdotool} \cite{3_2019}, uz èiju pomoæ možemo saznati PID (eng. \textit{Process ID}) trenutno korištene aplikacije. S tom informacijom, od poznate \textit{shell} naredbe \textit{ps} doznajemo ime procesa s tim PID-om.

Komande se spremaju kao JSON datoteke za svaku aplikaciju zasebno. Nazivi tih datoteka odgovaraju imenima procesa tih aplikacija u Linux sustavima.

\begin{figure}[!htbp]
	\begin{lstlisting}[language=json, label={code:2.1}, caption={Pokazni primjer moguæe JSON datoteke za konfiguraciju komandi u programu Google Chrome}]
{
   "Bookmark": {
      "type": "shortcut",
      "shortcuts": [
         [
         "ctrl",
         "d"
         ]
      ],
      "frequency": 0
   },
   "Clear Browsing Data": {
      "type": "shortcut",
      "shortcuts": [
         [
            "ctrl",
            "shift",
            "del"
         ]
      ],
      "frequency": 0
   }
}
	\end{lstlisting}
\end{figure}

U isjeèku koda \ref{code:2.1} možemo vidjeti kako bi izgledao JSON zapis komandi za program Google Chrome kada bismo imali samo dvije stavke. Pri tome, važno je napomenuti kako oznake za tipke koje èine odreðeni tipkovnièki preèac (\textit{ctrl}, \textit{shift}, \textit{del} i slièni) moraju odgovarati oznakama koje se pojavljuju u dokumentaciji za modul \textit{PyAutoGUI} \cite{4_2019}.

Prvo polje (u ovom primjeru \textit{Bookmark} i \textit{Clear Browsing Data}) predstavlja ime komande, odnosno ono što æe se korisniku univerzalne palete komandi prikazati na ekranu.

Polje \textit{frequency} oznaèava koliko je puta komanda bila korištena otkad je korisnik poèeo upotrebljavati univerzalnu paletu komandi. Može se zakljuèiti kako je jednostavno podešavati tu vrijednost, ukoliko postoji potreba za time.

Sve u svemu, JSON predstavlja prikladan format za zapis podataka ovakvog tipa, jer je jednostavan za uporabu i jasno èitljiv ljudima.

\section{Prezentacija}

Napisati prezentaciju.

\section{Izazovi i moguæa poboljšanja}

Napisati izazove i moguæa poboljšanja.